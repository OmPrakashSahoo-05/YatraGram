(this["webpackJsonpfrontend-app"]=this["webpackJsonpfrontend-app"]||[]).push([[0],{10:function(e,t,a){e.exports={title:"CredentialsForm_title__3CaBy",error:"CredentialsForm_error__23Sg-",formGroup:"CredentialsForm_formGroup__1b15o",separator:"CredentialsForm_separator__3U3bw",btn:"CredentialsForm_btn__B7JTI"}},11:function(e,t,a){e.exports={container:"Story_container___1d3D",author:"Story_author__Txx9d",mainContent:"Story_mainContent__3916l",title:"Story_title__PQTdj",authorName:"Story_authorName__2aUZt",deletion:"Story_deletion__3N1GX",avatar:"Story_avatar__svjSU"}},13:function(e,t,a){e.exports={container:"ProfileHeader_container__3RiEt",avatar:"ProfileHeader_avatar__HOKq-",author:"ProfileHeader_author__NnOB4",formGroup:"ProfileHeader_formGroup__2K66Y"}},17:function(e,t,a){e.exports={formGroup:"NewStory_formGroup__225lD"}},29:function(e,t,a){e.exports={container:"ErrorBox_container__N9119"}},30:function(e,t,a){e.exports={navbar:"Navbar_navbar__37b-J"}},32:function(e,t,a){e.exports={container:"Feed_container__2VHIq"}},33:function(e,t,a){e.exports={container:"LogIn_container__1OpZG"}},34:function(e,t,a){e.exports={container:"Profile_container__2geIX"}},35:function(e,t,a){e.exports={container:"SignUp_container__Z2mlO"}},41:function(e,t,a){},69:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(28),s=a.n(c),o=(a(41),a(9)),i=a(2),l=a(10),j=a.n(l),u=a(0);function b(e){const[t,a]=Object(n.useState)(""),[r,c]=Object(n.useState)(""),s="signup"===e.type?"Sign up":"Log in";return Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{className:j.a.title,children:s}),e.error&&Object(u.jsx)("div",{className:j.a.error,children:"login"===e.type?"Authentication failed.":"Registration failed."}),Object(u.jsxs)("form",{onSubmit:function(n){n.preventDefault(),a(""),c(""),e.onSubmit({email:t,password:r})},children:[Object(u.jsxs)("div",{className:j.a.formGroup,children:[Object(u.jsx)("label",{htmlFor:"email",children:"Email"}),Object(u.jsx)("input",{type:"email",name:"email",value:t,onChange:e=>a(e.target.value)})]}),Object(u.jsxs)("div",{className:j.a.formGroup,children:[Object(u.jsx)("label",{htmlFor:"password",children:"Password"}),Object(u.jsx)("input",{type:"password",name:"password",value:r,onChange:e=>c(e.target.value)})]}),Object(u.jsx)("div",{children:Object(u.jsx)("input",{type:"submit",value:s,className:"".concat(j.a.btn," btn btnPrimary")})})]}),Object(u.jsx)("div",{className:j.a.separator}),Object(u.jsx)("div",{children:Object(u.jsx)("form",{action:"/api/auth/google",method:"get",children:Object(u.jsx)("input",{type:"submit",value:"".concat(s," with Google"),className:"".concat(j.a.btn," btn")})})})]})}var d=a(29),h=a.n(d);function m(){return Object(u.jsx)("div",{className:"".concat(h.a.container," box"),children:"An error has occurred. Please try refreshing the page."})}var O=a(11),p=a.n(O);function x(e){return Object(u.jsxs)("div",{className:"".concat(p.a.container," box"),children:[!e.hideImage&&Object(u.jsx)("div",{className:p.a.author,children:Object(u.jsx)("img",{src:"api/profile/avatar?userId=".concat(e.story.author.id),className:p.a.avatar,alt:"avatar"})}),Object(u.jsxs)("div",{className:p.a.mainContent,children:[Object(u.jsx)("div",{className:p.a.title,children:e.story.title}),Object(u.jsxs)("div",{children:[Object(u.jsx)("a",{href:e.story.link,children:e.story.link}),Object(u.jsxs)("span",{className:p.a.authorName,children:[" - ",e.story.author.name]})]})]}),e.onDelete&&Object(u.jsx)("div",{className:p.a.deletion,children:Object(u.jsx)("button",{onClick:e.onDelete,className:"btn btnSmall",children:"X"})})]})}var f=a(17),v=a.n(f);function g(e){const[t,a]=Object(n.useState)(""),[r,c]=Object(n.useState)("");return Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:"Add a story"}),Object(u.jsxs)("form",{onSubmit:function(n){n.preventDefault(),a(""),c(""),e.onCreate({title:t,link:r})},children:[Object(u.jsxs)("div",{className:v.a.formGroup,children:[Object(u.jsx)("label",{htmlFor:"title",children:"Title:"}),Object(u.jsx)("input",{type:"text",name:"title",value:t,onChange:e=>a(e.target.value),required:!0})]}),Object(u.jsxs)("div",{className:v.a.formGroup,children:[Object(u.jsx)("label",{htmlFor:"link",children:"Link:"}),Object(u.jsx)("input",{type:"url",name:"link",value:r,onChange:e=>c(e.target.value),required:!0})]}),Object(u.jsx)("div",{children:Object(u.jsx)("button",{type:"submit",className:"btn",children:"Submit"})})]})]})}var _=a(8),y=a.n(_);async function N(e){return(await y.a.get("/api/stories",{params:{authorId:e}})).data}var S=a(30),w=a.n(S);function C(e){const t=Object(i.g)();return Object(u.jsxs)("div",{className:w.a.navbar,children:[Object(u.jsx)("div",{}),e.currentUser?Object(u.jsxs)(n.Fragment,{children:[Object(u.jsx)(o.b,{to:"/",className:"btn btnPrimary",children:"Feed"}),Object(u.jsx)(o.b,{to:"/profile",className:"btn btnPrimary",children:"Profile"}),Object(u.jsx)("button",{onClick:async function(){await async function(){await y.a.post("/api/auth/logout")}(),e.onLogOut(),t.push("/")},className:"btn",children:"Log out"})]}):Object(u.jsxs)(n.Fragment,{children:[Object(u.jsx)(o.b,{to:"/login",className:"btn btnPrimary",children:"Log in"}),Object(u.jsx)(o.b,{to:"/signup",className:"btn btnPrimary",children:"Sign up"})]})]})}var F=a(32),P=a.n(F);function U(){const[e,t]=Object(n.useState)(!1),[a,r]=Object(n.useState)([]),[c,s]=Object(n.useState)(!1);return Object(n.useEffect)((()=>{e||N().then((e=>{r(e),t(!0)})).catch((e=>{console.log(e),s(!0)}))})),Object(u.jsxs)("div",{className:P.a.container,children:[c&&Object(u.jsx)(m,{}),a.map((e=>Object(u.jsx)(x,{story:e},e.id)))]})}var G=a(33),I=a.n(G);function D(e){const[t,a]=Object(n.useState)(!1),r=Object(i.g)();return Object(u.jsx)("div",{className:"".concat(I.a.container," box"),children:Object(u.jsx)(b,{error:t,type:"login",onSubmit:async function(n){a(!1);try{const t=await async function(e){return(await y.a.post("/api/auth/login",e)).data}(n);e.onLogIn(t),r.push("/")}catch(t){console.log(t),a(!0)}}})})}var L=a(13),k=a.n(L);function E(e){const[t,a]=Object(n.useState)(e.username),[r,c]=Object(n.useState)(null);return Object(n.useEffect)((()=>{a(e.username)}),[e.username]),Object(u.jsxs)("div",{className:k.a.container,children:[Object(u.jsx)("div",{className:k.a.author,children:Object(u.jsx)("img",{src:"/api/profile/avatar?".concat(e.avatarCacheId),className:k.a.avatar,alt:"avatar"})}),Object(u.jsx)("div",{children:Object(u.jsxs)("form",{onSubmit:function(a){a.preventDefault(),e.onUpdate(t,r)},children:[Object(u.jsxs)("div",{className:k.a.formGroup,children:[Object(u.jsx)("label",{htmlFor:"name",children:"Name: "}),Object(u.jsx)("input",{type:"text",name:"name",value:t,onChange:e=>a(e.target.value)})]}),Object(u.jsxs)("div",{className:k.a.formGroup,children:[Object(u.jsx)("label",{htmlFor:"avatar",children:"Avatar: "}),Object(u.jsx)("input",{type:"file",name:"avatar",onChange:e=>c(e.target.files?e.target.files[0]:null)})]}),Object(u.jsx)("div",{children:Object(u.jsx)("input",{type:"submit",value:"Update profile",className:"btn btnSmall btnPrimary"})})]})})]})}var B=a(34),H=a.n(B);function T(e){const[t,a]=Object(n.useState)(!1),[r,c]=Object(n.useState)([]),[s,o]=Object(n.useState)(!1),[i,l]=Object(n.useState)(Date.now());function j(){N(e.currentUser.id).then((e=>{c(e),a(!0)})).catch((e=>{console.log(e),o(!0)}))}async function b(e){try{await async function(e){await y.a.delete("/api/stories/".concat(e))}(e.id),await j()}catch(s){console.log(s),o(!0)}}return Object(n.useEffect)((()=>{t||j()})),Object(u.jsxs)("div",{className:H.a.container,children:[s&&Object(u.jsx)(m,{}),Object(u.jsx)(E,{onUpdate:async function(t,a){try{await async function(e,t){const a=new FormData;a.set("name",e),t&&a.set("avatar",t),await y.a.post("/api/profile",a,{headers:{"content-type":"multipart/form-data"}})}(t,a),l(Date.now()),e.onProfileChange({...e.currentUser,name:t})}catch(s){console.log(s),o(!0)}},username:e.currentUser.name,avatarCacheId:i}),Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:"Your stories"}),r.map((e=>Object(u.jsx)(x,{hideImage:!0,story:e,onDelete:()=>b(e)},e.id)))]}),Object(u.jsx)(g,{onCreate:async function(e){try{await async function(e){await y.a.post("/api/stories",e)}(e),await j()}catch(s){console.log(s),o(!0)}}})]})}var J=a(35),q=a.n(J);function A(e){const[t,a]=Object(n.useState)(!1),r=Object(i.g)();return Object(u.jsx)("div",{className:"".concat(q.a.container," box"),children:Object(u.jsx)(b,{error:t,type:"signup",onSubmit:async function(n){try{const t=await async function(e){return(await y.a.post("/api/auth/signup",e)).data}(n);e.onSignUp(t),r.push("/")}catch(t){console.log(t),a(!0)}}})})}var X=a(36);function Z(){const[e,t]=Object(n.useState)(function(){const e=X.parse(document.cookie).user;if(!e)return null;try{return JSON.parse(e)}catch(t){return null}}());return Object(u.jsx)(o.a,{children:Object(u.jsx)("div",{children:Object(u.jsxs)(i.d,{children:[Object(u.jsx)(i.b,{exact:!0,path:"/login",children:Object(u.jsx)(D,{onLogIn:t})}),Object(u.jsx)(i.b,{exact:!0,path:"/profile",children:e?Object(u.jsxs)(n.Fragment,{children:[Object(u.jsx)(C,{currentUser:e,onLogOut:()=>t(null)}),Object(u.jsx)(T,{currentUser:e,onProfileChange:t})]}):Object(u.jsx)(i.a,{to:"/login"})}),Object(u.jsx)(i.b,{exact:!0,path:"/signup",children:Object(u.jsx)(A,{onSignUp:t})}),Object(u.jsxs)(i.b,{exact:!0,path:"/",children:[Object(u.jsx)(C,{currentUser:e,onLogOut:()=>t(null)}),Object(u.jsx)(U,{})]}),Object(u.jsx)(i.b,{path:"*",children:Object(u.jsx)(i.a,{to:"/"})})]})})})}var K=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,70)).then((t=>{let{getCLS:a,getFID:n,getFCP:r,getLCP:c,getTTFB:s}=t;a(e),n(e),r(e),c(e),s(e)}))};s.a.render(Object(u.jsx)(r.a.StrictMode,{children:Object(u.jsx)(Z,{})}),document.getElementById("root")),K()}},[[69,1,2]]]);
//# sourceMappingURL=main.771243d4.chunk.js.map